{
  "ast": null,
  "code": "import { mockRestaurantItems } from './mock/mockItems';\nimport { BehaviorSubject, of, ReplaySubject } from 'rxjs';\nimport { filter, map, switchMap, take, tap } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./services/restaurant-fs.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"./components/restaurant/restaurant.component\";\n\nfunction AppComponent_div_17_button_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 8);\n    i0.ɵɵlistener(\"click\", function AppComponent_div_17_button_5_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const restaurant_r3 = i0.ɵɵnextContext().$implicit;\n      const ctx_r6 = i0.ɵɵnextContext();\n      return ctx_r6.selectRestaurant(restaurant_r3);\n    });\n    i0.ɵɵtext(1, \"Expand \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction AppComponent_div_17_button_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 8);\n    i0.ɵɵlistener(\"click\", function AppComponent_div_17_button_7_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r9 = i0.ɵɵnextContext(2);\n      return ctx_r9.selectRestaurant(null);\n    });\n    i0.ɵɵtext(1, \" Compress \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction AppComponent_div_17_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 6);\n    i0.ɵɵelementStart(1, \"h3\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"p\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(5, AppComponent_div_17_button_5_Template, 2, 0, \"button\", 7);\n    i0.ɵɵpipe(6, \"async\");\n    i0.ɵɵtemplate(7, AppComponent_div_17_button_7_Template, 2, 0, \"button\", 7);\n    i0.ɵɵpipe(8, \"async\");\n    i0.ɵɵelementStart(9, \"button\", 8);\n    i0.ɵɵlistener(\"click\", function AppComponent_div_17_Template_button_click_9_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r12);\n      const restaurant_r3 = restoredCtx.$implicit;\n      const ctx_r11 = i0.ɵɵnextContext();\n      return ctx_r11.deleteRestaurant(restaurant_r3);\n    });\n    i0.ɵɵtext(10, \"Delete from firestore\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"button\", 8);\n    i0.ɵɵlistener(\"click\", function AppComponent_div_17_Template_button_click_11_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r12);\n      const restaurant_r3 = restoredCtx.$implicit;\n      const ctx_r13 = i0.ɵɵnextContext();\n      return ctx_r13.changeIdOfRestaurantToRandom(restaurant_r3);\n    });\n    i0.ɵɵtext(12, \"Change id to random\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const restaurant_r3 = ctx.$implicit;\n    const ctx_r0 = i0.ɵɵnextContext();\n    let tmp_2_0;\n    let tmp_3_0;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(restaurant_r3 == null ? null : restaurant_r3.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"id: \", restaurant_r3 == null ? null : restaurant_r3.firestoreMetadata == null ? null : restaurant_r3.firestoreMetadata.id, \"\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ((tmp_2_0 = i0.ɵɵpipeBind1(6, 4, ctx_r0.selectedRestaurant$)) == null ? null : tmp_2_0.firestoreMetadata == null ? null : tmp_2_0.firestoreMetadata.id) != restaurant_r3.firestoreMetadata.id);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ((tmp_3_0 = i0.ɵɵpipeBind1(8, 6, ctx_r0.selectedRestaurant$)) == null ? null : tmp_3_0.firestoreMetadata == null ? null : tmp_3_0.firestoreMetadata.id) == restaurant_r3.firestoreMetadata.id);\n  }\n}\n\nfunction AppComponent_ng_container_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"h2\");\n    i0.ɵɵtext(2, \"Selected Restaurant:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(3, \"app-restaurant\", 9);\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const fullRestaurant_r14 = ctx.ngIf;\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"restaurant\", fullRestaurant_r14);\n  }\n}\n\nfunction AppComponent_div_25_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r17 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 6);\n    i0.ɵɵelementStart(1, \"h3\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"button\", 8);\n    i0.ɵɵlistener(\"click\", function AppComponent_div_25_Template_button_click_3_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r17);\n      const restaurant_r15 = restoredCtx.$implicit;\n      const ctx_r16 = i0.ɵɵnextContext();\n      return ctx_r16.addRestaurant(restaurant_r15);\n    });\n    i0.ɵɵtext(4, \"Add to firestore\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const restaurant_r15 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(restaurant_r15 == null ? null : restaurant_r15.name);\n  }\n}\n\nexport class AppComponent {\n  constructor(restaurantFsService) {\n    this.restaurantFsService = restaurantFsService;\n    this.restaurants$ = new BehaviorSubject([]); // BehaviorSubject where the selected restaurant taken from firestore is kept, uses listenDeep to\n\n    this.selectedRestaurantFull$ = new ReplaySubject(undefined); // selected restaurant from firestore..does not contain reviews and dishes\n\n    this.selectedRestaurant$ = new ReplaySubject(undefined);\n    this.mockRestaurants = mockRestaurantItems; // list of mock restaurants\n\n    this.selectedMockRestaurant = null;\n    /* listen for restaurants and keep them in this.restaurants$ */\n\n    this.restaurantFsService.listenForRestaurants$().pipe(tap(restaurants => console.log(restaurants))).subscribe(restaurants => this.restaurants$.next(restaurants));\n    /* listen for selectedRestaurant$ and update selectedRestaurantFull$ if changed */\n\n    this.selectedRestaurant$.pipe(switchMap(restaurant => {\n      var _a;\n\n      if (restaurant != null) {\n        const id = (_a = restaurant === null || restaurant === void 0 ? void 0 : restaurant.firestoreMetadata) === null || _a === void 0 ? void 0 : _a.id;\n        return this.restaurantFsService.listenForRestaurantById$(id);\n      } else {\n        return of(null);\n      }\n    })).subscribe(restaurantFull => {\n      if (restaurantFull) {\n        this.selectedRestaurantFull$.next(restaurantFull);\n      }\n    });\n    /* set selectedRestaurant$ to null if not in firestore, meaning it has been deleted or had its id changed */\n\n    this.restaurants$.pipe(map(restaurants => restaurants.map(rest => rest.firestoreMetadata.id)), switchMap(restaurantIds => {\n      return this.selectedRestaurantFull$.pipe(take(1), filter(selectedRestaurant => selectedRestaurant != null), map(selectedRestaurant => selectedRestaurant.firestoreMetadata.id), tap(selectedRestaurantId => {\n        if (restaurantIds.findIndex(id => id === selectedRestaurantId) === -1) {\n          // selected restaurant id not in restaurants\n          this.selectedRestaurant$.next(null);\n        }\n      }));\n    })).subscribe();\n  }\n\n  addRestaurant(restaurant) {\n    this.restaurantFsService.addRestaurant$(restaurant).subscribe();\n  }\n\n  deleteRestaurant(restaurant) {\n    this.restaurantFsService.deleteRestaurantById$(restaurant.firestoreMetadata.id).subscribe();\n  }\n\n  deleteAllRestaurants() {\n    this.restaurantFsService.deleteAllRestaurants$().subscribe();\n  }\n\n  selectMockRestaurant(restaurant) {\n    this.selectedMockRestaurant = restaurant;\n  }\n\n  selectRestaurant(restaurant) {\n    this.selectedRestaurant$.next(restaurant);\n  }\n  /**\r\n   * Just a method to show an example of changeDocId$\r\n   */\n\n\n  changeIdOfRestaurantToRandom(restaurant) {\n    const randomId = Math.random().toString(36).substr(10, 15);\n    this.restaurantFsService.changeIdOfRestaurant$(restaurant, randomId).subscribe();\n  }\n\n}\n\nAppComponent.ɵfac = function AppComponent_Factory(t) {\n  return new (t || AppComponent)(i0.ɵɵdirectiveInject(i1.RestaurantFsService));\n};\n\nAppComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: AppComponent,\n  selectors: [[\"app-root\"]],\n  decls: 34,\n  vars: 7,\n  consts: [[1, \"main-container\"], [1, \"highlight\"], [\"class\", \"restaurant-container\", 4, \"ngFor\", \"ngForOf\"], [4, \"ngIf\"], [\"href\", \"https://github.com/Tylder/firestore-deep/tree/master/projects/firestore-deep\"], [\"href\", \"https://angularfirestore-deep.web.app/docs/\"], [1, \"restaurant-container\"], [\"class\", \"button\", 3, \"click\", 4, \"ngIf\"], [1, \"button\", 3, \"click\"], [3, \"restaurant\"]],\n  template: function AppComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵelementStart(1, \"h1\");\n      i0.ɵɵtext(2, \"Firestore-Extended Demo\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(3, \"p\", 1);\n      i0.ɵɵtext(4, \"The purpose of this 'demo' is to show common work flows and give examples on how to perform them.\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(5, \"p\", 1);\n      i0.ɵɵtext(6, \"In order to get the most out of this demo you should be checking out the code on github at the same time or even better run a local demo, that way you can play around with the code.\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(7, \"h2\");\n      i0.ɵɵtext(8, \"Restaurants in firestore: \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(9, \"p\", 1);\n      i0.ɵɵtext(10, \"These restaurants are saved on firestore, press 'Expand' to see the full restaurant object under 'Selected Restaurant'\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(11, \"p\", 1);\n      i0.ɵɵtext(12, \"Press 'Delete from firestore' to perform a delete of the restaurant docucument and all its child documents\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(13, \"p\", 1);\n      i0.ɵɵtext(14, \"Press 'Change id to random' to change the id of restaurant document\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(15, \"p\", 1);\n      i0.ɵɵtext(16, \"Press 'Delete All' to delete all restaurant documents and all their child documents\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(17, AppComponent_div_17_Template, 13, 8, \"div\", 2);\n      i0.ɵɵpipe(18, \"async\");\n      i0.ɵɵtemplate(19, AppComponent_ng_container_19_Template, 4, 1, \"ng-container\", 3);\n      i0.ɵɵpipe(20, \"async\");\n      i0.ɵɵelementStart(21, \"h2\");\n      i0.ɵɵtext(22, \"Mock Restaurants\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(23, \"p\", 1);\n      i0.ɵɵtext(24, \"Press 'Add to firestore' to add a mock restaurant to firestore using AngularFirestore-Deep\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(25, AppComponent_div_25_Template, 5, 1, \"div\", 2);\n      i0.ɵɵelementStart(26, \"h4\");\n      i0.ɵɵtext(27, \"Daniel Lofgren MIT License\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(28, \"p\");\n      i0.ɵɵelementStart(29, \"a\", 4);\n      i0.ɵɵtext(30, \"Github\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(31, \"p\");\n      i0.ɵɵelementStart(32, \"a\", 5);\n      i0.ɵɵtext(33, \"Documentation\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(17);\n      i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(18, 3, ctx.restaurants$));\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(20, 5, ctx.selectedRestaurantFull$));\n      i0.ɵɵadvance(6);\n      i0.ɵɵproperty(\"ngForOf\", ctx.mockRestaurants);\n    }\n  },\n  directives: [i2.NgForOf, i2.NgIf, i3.RestaurantComponent],\n  pipes: [i2.AsyncPipe],\n  styles: [\".main-container[_ngcontent-%COMP%] {\\n  max-width: 800px;\\n  padding: 10px 10px 10px 10px;\\n  margin: auto;\\n}\\n\\nli[_ngcontent-%COMP%] {\\n  margin: 10px 0;\\n}\\n\\n.button[_ngcontent-%COMP%] {\\n  padding: 5px;\\n  margin-right: 10px;\\n}\\n\\n.button[_ngcontent-%COMP%]:last-child {\\n  margin-right: 0;\\n}\\n\\n.highlight[_ngcontent-%COMP%] {\\n  color: #c00000;\\n}\\n\\n.restaurant-container[_ngcontent-%COMP%] {\\n  border: #d7d7d7 1px solid;\\n  background-color: #f8f8f8;\\n  padding: 10px;\\n  border-radius: 5px;\\n  margin-bottom: 5px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGdCQUFBO0VBQ0EsNEJBQUE7RUFDQSxZQUFBO0FBQ0Y7O0FBRUE7RUFDRSxjQUFBO0FBQ0Y7O0FBRUE7RUFDRSxZQUFBO0VBRUEsa0JBQUE7QUFBRjs7QUFFRTtFQUNFLGVBQUE7QUFBSjs7QUFJQTtFQUNFLGNBQUE7QUFERjs7QUFLQTtFQUNFLHlCQUFBO0VBQ0EseUJBQUE7RUFDQSxhQUFBO0VBQ0Esa0JBQUE7RUFFQSxrQkFBQTtBQUhGIiwiZmlsZSI6ImFwcC5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi5tYWluLWNvbnRhaW5lciB7XHJcbiAgbWF4LXdpZHRoOiA4MDBweDtcclxuICBwYWRkaW5nOiAxMHB4IDEwcHggMTBweCAxMHB4O1xyXG4gIG1hcmdpbjogYXV0bztcclxufVxyXG5cclxubGkge1xyXG4gIG1hcmdpbjogMTBweCAwO1xyXG59XHJcblxyXG4uYnV0dG9uIHtcclxuICBwYWRkaW5nOiA1cHg7XHJcblxyXG4gIG1hcmdpbi1yaWdodDogMTBweDtcclxuXHJcbiAgJjpsYXN0LWNoaWxkIHtcclxuICAgIG1hcmdpbi1yaWdodDogMDtcclxuICB9XHJcbn1cclxuXHJcbi5oaWdobGlnaHQge1xyXG4gIGNvbG9yOiAjYzAwMDAwO1xyXG4gIC8vZm9udC13ZWlnaHQ6IGJvbGQ7XHJcbn1cclxuXHJcbi5yZXN0YXVyYW50LWNvbnRhaW5lciB7XHJcbiAgYm9yZGVyOiAjZDdkN2Q3IDFweCBzb2xpZDtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjhmOGY4O1xyXG4gIHBhZGRpbmc6IDEwcHg7XHJcbiAgYm9yZGVyLXJhZGl1czogNXB4O1xyXG5cclxuICBtYXJnaW4tYm90dG9tOiA1cHg7XHJcbn1cclxuIl19 */\"]\n});",
  "map": {
    "version": 3,
    "sources": [
      "D:/Programming/web/ng/libraries/firestore-extended/projects/demo/src/app/app.component.ts"
    ],
    "names": [
      "mockRestaurantItems",
      "BehaviorSubject",
      "of",
      "ReplaySubject",
      "filter",
      "map",
      "switchMap",
      "take",
      "tap",
      "i0",
      "i1",
      "i2",
      "i3",
      "AppComponent_div_17_button_5_Template",
      "rf",
      "ctx",
      "_r8",
      "ɵɵgetCurrentView",
      "ɵɵelementStart",
      "ɵɵlistener",
      "AppComponent_div_17_button_5_Template_button_click_0_listener",
      "ɵɵrestoreView",
      "restaurant_r3",
      "ɵɵnextContext",
      "$implicit",
      "ctx_r6",
      "selectRestaurant",
      "ɵɵtext",
      "ɵɵelementEnd",
      "AppComponent_div_17_button_7_Template",
      "_r10",
      "AppComponent_div_17_button_7_Template_button_click_0_listener",
      "ctx_r9",
      "AppComponent_div_17_Template",
      "_r12",
      "ɵɵtemplate",
      "ɵɵpipe",
      "AppComponent_div_17_Template_button_click_9_listener",
      "restoredCtx",
      "ctx_r11",
      "deleteRestaurant",
      "AppComponent_div_17_Template_button_click_11_listener",
      "ctx_r13",
      "changeIdOfRestaurantToRandom",
      "ctx_r0",
      "tmp_2_0",
      "tmp_3_0",
      "ɵɵadvance",
      "ɵɵtextInterpolate",
      "name",
      "ɵɵtextInterpolate1",
      "firestoreMetadata",
      "id",
      "ɵɵproperty",
      "ɵɵpipeBind1",
      "selectedRestaurant$",
      "AppComponent_ng_container_19_Template",
      "ɵɵelementContainerStart",
      "ɵɵelement",
      "ɵɵelementContainerEnd",
      "fullRestaurant_r14",
      "ngIf",
      "AppComponent_div_25_Template",
      "_r17",
      "AppComponent_div_25_Template_button_click_3_listener",
      "restaurant_r15",
      "ctx_r16",
      "addRestaurant",
      "AppComponent",
      "constructor",
      "restaurantFsService",
      "restaurants$",
      "selectedRestaurantFull$",
      "undefined",
      "mockRestaurants",
      "selectedMockRestaurant",
      "listenForRestaurants$",
      "pipe",
      "restaurants",
      "console",
      "log",
      "subscribe",
      "next",
      "restaurant",
      "_a",
      "listenForRestaurantById$",
      "restaurantFull",
      "rest",
      "restaurantIds",
      "selectedRestaurant",
      "selectedRestaurantId",
      "findIndex",
      "addRestaurant$",
      "deleteRestaurantById$",
      "deleteAllRestaurants",
      "deleteAllRestaurants$",
      "selectMockRestaurant",
      "randomId",
      "Math",
      "random",
      "toString",
      "substr",
      "changeIdOfRestaurant$",
      "ɵfac",
      "AppComponent_Factory",
      "t",
      "ɵɵdirectiveInject",
      "RestaurantFsService",
      "ɵcmp",
      "ɵɵdefineComponent",
      "type",
      "selectors",
      "decls",
      "vars",
      "consts",
      "template",
      "AppComponent_Template",
      "directives",
      "NgForOf",
      "NgIf",
      "RestaurantComponent",
      "pipes",
      "AsyncPipe",
      "styles"
    ],
    "mappings": "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",
    "sourcesContent": [
      "import { mockRestaurantItems } from './mock/mockItems';\r\nimport { BehaviorSubject, of, ReplaySubject } from 'rxjs';\r\nimport { filter, map, switchMap, take, tap } from 'rxjs/operators';\r\nimport * as i0 from \"@angular/core\";\r\nimport * as i1 from \"./services/restaurant-fs.service\";\r\nimport * as i2 from \"@angular/common\";\r\nimport * as i3 from \"./components/restaurant/restaurant.component\";\r\nfunction AppComponent_div_17_button_5_Template(rf, ctx) { if (rf & 1) {\r\n    const _r8 = i0.ɵɵgetCurrentView();\r\n    i0.ɵɵelementStart(0, \"button\", 8);\r\n    i0.ɵɵlistener(\"click\", function AppComponent_div_17_button_5_Template_button_click_0_listener() { i0.ɵɵrestoreView(_r8); const restaurant_r3 = i0.ɵɵnextContext().$implicit; const ctx_r6 = i0.ɵɵnextContext(); return ctx_r6.selectRestaurant(restaurant_r3); });\r\n    i0.ɵɵtext(1, \"Expand \");\r\n    i0.ɵɵelementEnd();\r\n} }\r\nfunction AppComponent_div_17_button_7_Template(rf, ctx) { if (rf & 1) {\r\n    const _r10 = i0.ɵɵgetCurrentView();\r\n    i0.ɵɵelementStart(0, \"button\", 8);\r\n    i0.ɵɵlistener(\"click\", function AppComponent_div_17_button_7_Template_button_click_0_listener() { i0.ɵɵrestoreView(_r10); const ctx_r9 = i0.ɵɵnextContext(2); return ctx_r9.selectRestaurant(null); });\r\n    i0.ɵɵtext(1, \" Compress \");\r\n    i0.ɵɵelementEnd();\r\n} }\r\nfunction AppComponent_div_17_Template(rf, ctx) { if (rf & 1) {\r\n    const _r12 = i0.ɵɵgetCurrentView();\r\n    i0.ɵɵelementStart(0, \"div\", 6);\r\n    i0.ɵɵelementStart(1, \"h3\");\r\n    i0.ɵɵtext(2);\r\n    i0.ɵɵelementEnd();\r\n    i0.ɵɵelementStart(3, \"p\");\r\n    i0.ɵɵtext(4);\r\n    i0.ɵɵelementEnd();\r\n    i0.ɵɵtemplate(5, AppComponent_div_17_button_5_Template, 2, 0, \"button\", 7);\r\n    i0.ɵɵpipe(6, \"async\");\r\n    i0.ɵɵtemplate(7, AppComponent_div_17_button_7_Template, 2, 0, \"button\", 7);\r\n    i0.ɵɵpipe(8, \"async\");\r\n    i0.ɵɵelementStart(9, \"button\", 8);\r\n    i0.ɵɵlistener(\"click\", function AppComponent_div_17_Template_button_click_9_listener() { const restoredCtx = i0.ɵɵrestoreView(_r12); const restaurant_r3 = restoredCtx.$implicit; const ctx_r11 = i0.ɵɵnextContext(); return ctx_r11.deleteRestaurant(restaurant_r3); });\r\n    i0.ɵɵtext(10, \"Delete from firestore\");\r\n    i0.ɵɵelementEnd();\r\n    i0.ɵɵelementStart(11, \"button\", 8);\r\n    i0.ɵɵlistener(\"click\", function AppComponent_div_17_Template_button_click_11_listener() { const restoredCtx = i0.ɵɵrestoreView(_r12); const restaurant_r3 = restoredCtx.$implicit; const ctx_r13 = i0.ɵɵnextContext(); return ctx_r13.changeIdOfRestaurantToRandom(restaurant_r3); });\r\n    i0.ɵɵtext(12, \"Change id to random\");\r\n    i0.ɵɵelementEnd();\r\n    i0.ɵɵelementEnd();\r\n} if (rf & 2) {\r\n    const restaurant_r3 = ctx.$implicit;\r\n    const ctx_r0 = i0.ɵɵnextContext();\r\n    let tmp_2_0;\r\n    let tmp_3_0;\r\n    i0.ɵɵadvance(2);\r\n    i0.ɵɵtextInterpolate(restaurant_r3 == null ? null : restaurant_r3.name);\r\n    i0.ɵɵadvance(2);\r\n    i0.ɵɵtextInterpolate1(\"id: \", restaurant_r3 == null ? null : restaurant_r3.firestoreMetadata == null ? null : restaurant_r3.firestoreMetadata.id, \"\");\r\n    i0.ɵɵadvance(1);\r\n    i0.ɵɵproperty(\"ngIf\", ((tmp_2_0 = i0.ɵɵpipeBind1(6, 4, ctx_r0.selectedRestaurant$)) == null ? null : tmp_2_0.firestoreMetadata == null ? null : tmp_2_0.firestoreMetadata.id) != restaurant_r3.firestoreMetadata.id);\r\n    i0.ɵɵadvance(2);\r\n    i0.ɵɵproperty(\"ngIf\", ((tmp_3_0 = i0.ɵɵpipeBind1(8, 6, ctx_r0.selectedRestaurant$)) == null ? null : tmp_3_0.firestoreMetadata == null ? null : tmp_3_0.firestoreMetadata.id) == restaurant_r3.firestoreMetadata.id);\r\n} }\r\nfunction AppComponent_ng_container_19_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementContainerStart(0);\r\n    i0.ɵɵelementStart(1, \"h2\");\r\n    i0.ɵɵtext(2, \"Selected Restaurant:\");\r\n    i0.ɵɵelementEnd();\r\n    i0.ɵɵelement(3, \"app-restaurant\", 9);\r\n    i0.ɵɵelementContainerEnd();\r\n} if (rf & 2) {\r\n    const fullRestaurant_r14 = ctx.ngIf;\r\n    i0.ɵɵadvance(3);\r\n    i0.ɵɵproperty(\"restaurant\", fullRestaurant_r14);\r\n} }\r\nfunction AppComponent_div_25_Template(rf, ctx) { if (rf & 1) {\r\n    const _r17 = i0.ɵɵgetCurrentView();\r\n    i0.ɵɵelementStart(0, \"div\", 6);\r\n    i0.ɵɵelementStart(1, \"h3\");\r\n    i0.ɵɵtext(2);\r\n    i0.ɵɵelementEnd();\r\n    i0.ɵɵelementStart(3, \"button\", 8);\r\n    i0.ɵɵlistener(\"click\", function AppComponent_div_25_Template_button_click_3_listener() { const restoredCtx = i0.ɵɵrestoreView(_r17); const restaurant_r15 = restoredCtx.$implicit; const ctx_r16 = i0.ɵɵnextContext(); return ctx_r16.addRestaurant(restaurant_r15); });\r\n    i0.ɵɵtext(4, \"Add to firestore\");\r\n    i0.ɵɵelementEnd();\r\n    i0.ɵɵelementEnd();\r\n} if (rf & 2) {\r\n    const restaurant_r15 = ctx.$implicit;\r\n    i0.ɵɵadvance(2);\r\n    i0.ɵɵtextInterpolate(restaurant_r15 == null ? null : restaurant_r15.name);\r\n} }\r\nexport class AppComponent {\r\n    constructor(restaurantFsService) {\r\n        this.restaurantFsService = restaurantFsService;\r\n        this.restaurants$ = new BehaviorSubject([]);\r\n        // BehaviorSubject where the selected restaurant taken from firestore is kept, uses listenDeep to\r\n        this.selectedRestaurantFull$ = new ReplaySubject(undefined);\r\n        // selected restaurant from firestore..does not contain reviews and dishes\r\n        this.selectedRestaurant$ = new ReplaySubject(undefined);\r\n        this.mockRestaurants = mockRestaurantItems; // list of mock restaurants\r\n        this.selectedMockRestaurant = null;\r\n        /* listen for restaurants and keep them in this.restaurants$ */\r\n        this.restaurantFsService.listenForRestaurants$().pipe(tap((restaurants) => console.log(restaurants))).subscribe((restaurants) => this.restaurants$.next(restaurants));\r\n        /* listen for selectedRestaurant$ and update selectedRestaurantFull$ if changed */\r\n        this.selectedRestaurant$.pipe(switchMap((restaurant) => {\r\n            var _a;\r\n            if (restaurant != null) {\r\n                const id = (_a = restaurant === null || restaurant === void 0 ? void 0 : restaurant.firestoreMetadata) === null || _a === void 0 ? void 0 : _a.id;\r\n                return this.restaurantFsService.listenForRestaurantById$(id);\r\n            }\r\n            else {\r\n                return of(null);\r\n            }\r\n        })).subscribe((restaurantFull) => {\r\n            if (restaurantFull) {\r\n                this.selectedRestaurantFull$.next(restaurantFull);\r\n            }\r\n        });\r\n        /* set selectedRestaurant$ to null if not in firestore, meaning it has been deleted or had its id changed */\r\n        this.restaurants$.pipe(map((restaurants) => restaurants.map(rest => rest.firestoreMetadata.id)), switchMap((restaurantIds) => {\r\n            return this.selectedRestaurantFull$.pipe(take(1), filter(selectedRestaurant => selectedRestaurant != null), map((selectedRestaurant) => selectedRestaurant.firestoreMetadata.id), tap(selectedRestaurantId => {\r\n                if (restaurantIds.findIndex(id => id === selectedRestaurantId) === -1) { // selected restaurant id not in restaurants\r\n                    this.selectedRestaurant$.next(null);\r\n                }\r\n            }));\r\n        })).subscribe();\r\n    }\r\n    addRestaurant(restaurant) {\r\n        this.restaurantFsService.addRestaurant$(restaurant).subscribe();\r\n    }\r\n    deleteRestaurant(restaurant) {\r\n        this.restaurantFsService.deleteRestaurantById$(restaurant.firestoreMetadata.id).subscribe();\r\n    }\r\n    deleteAllRestaurants() {\r\n        this.restaurantFsService.deleteAllRestaurants$().subscribe();\r\n    }\r\n    selectMockRestaurant(restaurant) {\r\n        this.selectedMockRestaurant = restaurant;\r\n    }\r\n    selectRestaurant(restaurant) {\r\n        this.selectedRestaurant$.next(restaurant);\r\n    }\r\n    /**\r\n     * Just a method to show an example of changeDocId$\r\n     */\r\n    changeIdOfRestaurantToRandom(restaurant) {\r\n        const randomId = Math.random().toString(36).substr(10, 15);\r\n        this.restaurantFsService.changeIdOfRestaurant$(restaurant, randomId).subscribe();\r\n    }\r\n}\r\nAppComponent.ɵfac = function AppComponent_Factory(t) { return new (t || AppComponent)(i0.ɵɵdirectiveInject(i1.RestaurantFsService)); };\r\nAppComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: AppComponent, selectors: [[\"app-root\"]], decls: 34, vars: 7, consts: [[1, \"main-container\"], [1, \"highlight\"], [\"class\", \"restaurant-container\", 4, \"ngFor\", \"ngForOf\"], [4, \"ngIf\"], [\"href\", \"https://github.com/Tylder/firestore-deep/tree/master/projects/firestore-deep\"], [\"href\", \"https://angularfirestore-deep.web.app/docs/\"], [1, \"restaurant-container\"], [\"class\", \"button\", 3, \"click\", 4, \"ngIf\"], [1, \"button\", 3, \"click\"], [3, \"restaurant\"]], template: function AppComponent_Template(rf, ctx) { if (rf & 1) {\r\n        i0.ɵɵelementStart(0, \"div\", 0);\r\n        i0.ɵɵelementStart(1, \"h1\");\r\n        i0.ɵɵtext(2, \"Firestore-Extended Demo\");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(3, \"p\", 1);\r\n        i0.ɵɵtext(4, \"The purpose of this 'demo' is to show common work flows and give examples on how to perform them.\");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(5, \"p\", 1);\r\n        i0.ɵɵtext(6, \"In order to get the most out of this demo you should be checking out the code on github at the same time or even better run a local demo, that way you can play around with the code.\");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(7, \"h2\");\r\n        i0.ɵɵtext(8, \"Restaurants in firestore: \");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(9, \"p\", 1);\r\n        i0.ɵɵtext(10, \"These restaurants are saved on firestore, press 'Expand' to see the full restaurant object under 'Selected Restaurant'\");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(11, \"p\", 1);\r\n        i0.ɵɵtext(12, \"Press 'Delete from firestore' to perform a delete of the restaurant docucument and all its child documents\");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(13, \"p\", 1);\r\n        i0.ɵɵtext(14, \"Press 'Change id to random' to change the id of restaurant document\");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(15, \"p\", 1);\r\n        i0.ɵɵtext(16, \"Press 'Delete All' to delete all restaurant documents and all their child documents\");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵtemplate(17, AppComponent_div_17_Template, 13, 8, \"div\", 2);\r\n        i0.ɵɵpipe(18, \"async\");\r\n        i0.ɵɵtemplate(19, AppComponent_ng_container_19_Template, 4, 1, \"ng-container\", 3);\r\n        i0.ɵɵpipe(20, \"async\");\r\n        i0.ɵɵelementStart(21, \"h2\");\r\n        i0.ɵɵtext(22, \"Mock Restaurants\");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(23, \"p\", 1);\r\n        i0.ɵɵtext(24, \"Press 'Add to firestore' to add a mock restaurant to firestore using AngularFirestore-Deep\");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵtemplate(25, AppComponent_div_25_Template, 5, 1, \"div\", 2);\r\n        i0.ɵɵelementStart(26, \"h4\");\r\n        i0.ɵɵtext(27, \"Daniel Lofgren MIT License\");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(28, \"p\");\r\n        i0.ɵɵelementStart(29, \"a\", 4);\r\n        i0.ɵɵtext(30, \"Github\");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(31, \"p\");\r\n        i0.ɵɵelementStart(32, \"a\", 5);\r\n        i0.ɵɵtext(33, \"Documentation\");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n    } if (rf & 2) {\r\n        i0.ɵɵadvance(17);\r\n        i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(18, 3, ctx.restaurants$));\r\n        i0.ɵɵadvance(2);\r\n        i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(20, 5, ctx.selectedRestaurantFull$));\r\n        i0.ɵɵadvance(6);\r\n        i0.ɵɵproperty(\"ngForOf\", ctx.mockRestaurants);\r\n    } }, directives: [i2.NgForOf, i2.NgIf, i3.RestaurantComponent], pipes: [i2.AsyncPipe], styles: [\".main-container[_ngcontent-%COMP%] {\\n  max-width: 800px;\\n  padding: 10px 10px 10px 10px;\\n  margin: auto;\\n}\\n\\nli[_ngcontent-%COMP%] {\\n  margin: 10px 0;\\n}\\n\\n.button[_ngcontent-%COMP%] {\\n  padding: 5px;\\n  margin-right: 10px;\\n}\\n\\n.button[_ngcontent-%COMP%]:last-child {\\n  margin-right: 0;\\n}\\n\\n.highlight[_ngcontent-%COMP%] {\\n  color: #c00000;\\n}\\n\\n.restaurant-container[_ngcontent-%COMP%] {\\n  border: #d7d7d7 1px solid;\\n  background-color: #f8f8f8;\\n  padding: 10px;\\n  border-radius: 5px;\\n  margin-bottom: 5px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGdCQUFBO0VBQ0EsNEJBQUE7RUFDQSxZQUFBO0FBQ0Y7O0FBRUE7RUFDRSxjQUFBO0FBQ0Y7O0FBRUE7RUFDRSxZQUFBO0VBRUEsa0JBQUE7QUFBRjs7QUFFRTtFQUNFLGVBQUE7QUFBSjs7QUFJQTtFQUNFLGNBQUE7QUFERjs7QUFLQTtFQUNFLHlCQUFBO0VBQ0EseUJBQUE7RUFDQSxhQUFBO0VBQ0Esa0JBQUE7RUFFQSxrQkFBQTtBQUhGIiwiZmlsZSI6ImFwcC5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi5tYWluLWNvbnRhaW5lciB7XHJcbiAgbWF4LXdpZHRoOiA4MDBweDtcclxuICBwYWRkaW5nOiAxMHB4IDEwcHggMTBweCAxMHB4O1xyXG4gIG1hcmdpbjogYXV0bztcclxufVxyXG5cclxubGkge1xyXG4gIG1hcmdpbjogMTBweCAwO1xyXG59XHJcblxyXG4uYnV0dG9uIHtcclxuICBwYWRkaW5nOiA1cHg7XHJcblxyXG4gIG1hcmdpbi1yaWdodDogMTBweDtcclxuXHJcbiAgJjpsYXN0LWNoaWxkIHtcclxuICAgIG1hcmdpbi1yaWdodDogMDtcclxuICB9XHJcbn1cclxuXHJcbi5oaWdobGlnaHQge1xyXG4gIGNvbG9yOiAjYzAwMDAwO1xyXG4gIC8vZm9udC13ZWlnaHQ6IGJvbGQ7XHJcbn1cclxuXHJcbi5yZXN0YXVyYW50LWNvbnRhaW5lciB7XHJcbiAgYm9yZGVyOiAjZDdkN2Q3IDFweCBzb2xpZDtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjhmOGY4O1xyXG4gIHBhZGRpbmc6IDEwcHg7XHJcbiAgYm9yZGVyLXJhZGl1czogNXB4O1xyXG5cclxuICBtYXJnaW4tYm90dG9tOiA1cHg7XHJcbn1cclxuIl19 */\"] });\r\n"
    ]
  },
  "metadata": {},
  "sourceType": "module"
}
